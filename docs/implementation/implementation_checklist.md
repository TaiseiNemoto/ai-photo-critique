# å®Ÿè£…çŠ¶æ³ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ - AI Photo Critique

## æ©Ÿèƒ½å®Ÿè£…çŠ¶æ³

### âœ… å®Œäº†æ¸ˆã¿æ©Ÿèƒ½

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ UI

- [x] **UploadZone** - ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã€ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
- [x] **ImagePreview** - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- [x] **ExifDisplay** - EXIFæƒ…å ±ã®ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
- [x] **GenerateButton** - è¬›è©•ç”Ÿæˆãƒœã‚¿ãƒ³ï¼ˆçŠ¶æ…‹ç®¡ç†ä»˜ãï¼‰
- [x] **CritiqueCard** - 3è»¸è¬›è©•ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
- [x] **ReportActions** - å…±æœ‰ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
- [x] **SharePage** - å…±æœ‰ãƒšãƒ¼ã‚¸ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

#### ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- [x] **EXIFæŠ½å‡º** (`src/lib/exif.ts`) - exifrãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ç”¨
- [x] **ç”»åƒå‡¦ç†** (`src/lib/image.ts`) - Sharpã«ã‚ˆã‚‹ãƒªã‚µã‚¤ã‚º
- [x] **Geminiçµ±åˆ** (`src/lib/gemini.ts`) - Vision APIå‘¼ã³å‡ºã—
- [x] **Upstash Redisçµ±åˆ** (`src/lib/kv.ts`) - ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
- [x] **å‹å®šç¾©** (`src/types/upload.ts`) - TypeScriptå‹å®‰å…¨æ€§

#### ãƒ†ã‚¹ãƒˆåŸºç›¤

- [x] **å˜ä½“ãƒ†ã‚¹ãƒˆ** - Vitest + React Testing Library
- [x] **APIãƒ¢ãƒƒã‚¯** - MSW (Mock Service Worker)
- [x] **E2EåŸºç›¤** - Playwrightè¨­å®šæ¸ˆã¿

### ğŸ”§ éƒ¨åˆ†å®Ÿè£…

#### Server Actionsï¼ˆè¦API Routeçµ±åˆï¼‰

- [x] **uploadImage** - ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã®ã¿ã€KVä¿å­˜æœªå®Ÿè£…
- [x] **generateCritique** - Geminiå‘¼ã³å‡ºã—å®Ÿè£…æ¸ˆã¿
- [ ] **API Routeçµ±åˆ** - `/api/*` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…

#### å…±æœ‰æ©Ÿèƒ½

- [x] **å…±æœ‰ãƒšãƒ¼ã‚¸UI** - `/s/[id]` ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®Œæˆ
- [ ] **OGPç”»åƒç”Ÿæˆ** - `/api/ogp` æœªå®Ÿè£…
- [ ] **çŸ­ç¸®URLæ©Ÿèƒ½** - KVçµ±åˆå¾…ã¡

### âŒ æœªå®Ÿè£…ï¼ˆMVPå¿…é ˆï¼‰

#### API Routes

- [ ] **`/api/upload`** - Edge Function (ç”»åƒå‡¦ç† + KVä¿å­˜)
- [ ] **`/api/critique`** - Node Function (Gemini API)
- [ ] **`/api/ogp`** - Edge Function (Satori + OGPç”»åƒç”Ÿæˆ)

#### ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

- [x] **KVã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…** - ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒª/Upstashå¯¾å¿œå®Œäº†
- [x] **ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒ** - CritiqueData, ShareDataå‹å®šç¾©æ¸ˆã¿
- [x] **TTLç®¡ç†** - 24æ™‚é–“è‡ªå‹•å‰Šé™¤å®Ÿè£…
- [x] **Upstash Redisæ¥ç¶š** - ç’°å¢ƒå¤‰æ•°è¨­å®šãƒ»å‹•ä½œç¢ºèªå®Œäº†
- [x] **æœ¬ç•ªç’°å¢ƒãƒ†ã‚¹ãƒˆ** - å®Ÿéš›ã®Redisç’°å¢ƒã§ã®å‹•ä½œç¢ºèªå®Œäº†

#### é‹ç”¨æ©Ÿèƒ½

- [ ] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** - APIå¤±æ•—æ™‚ã®é©åˆ‡ãªå¯¾å¿œ
- [ ] **ãƒ­ã‚°å‡ºåŠ›** - ãƒ‡ãƒãƒƒã‚°ãƒ»ç›£è¦–ç”¨
- [ ] **ãƒ¬ãƒ¼ãƒˆåˆ¶é™** - APIä½¿ç”¨é‡åˆ¶å¾¡
- [ ] **ç’°å¢ƒå¤‰æ•°ç®¡ç†** - æœ¬ç•ªè¨­å®š

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…çŠ¶æ³

### Core Components

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | çŠ¶æ…‹ | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹                               | å‚™è€ƒ              |
| -------------- | ---- | ------------------------------------------ | ----------------- |
| UploadZone     | âœ…   | `src/components/upload/UploadZone.tsx`     | Drag&Dropå®Ÿè£…æ¸ˆã¿ |
| ImagePreview   | âœ…   | `src/components/upload/ImagePreview.tsx`   | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º    |
| ExifDisplay    | âœ…   | `src/components/upload/ExifDisplay.tsx`    | EXIFè¡¨ç¤º          |
| GenerateButton | âœ…   | `src/components/upload/GenerateButton.tsx` | çŠ¶æ…‹ç®¡ç†å¼·åŒ–æ¸ˆã¿  |
| CritiqueCard   | âœ…   | `src/components/report/CritiqueCard.tsx`   | 3è»¸ã‚«ãƒ¼ãƒ‰è¡¨ç¤º     |
| ReportActions  | âœ…   | `src/components/report/ReportActions.tsx`  | å…±æœ‰ã‚¢ã‚¯ã‚·ãƒ§ãƒ³    |

### Page Components

| ãƒšãƒ¼ã‚¸      | çŠ¶æ…‹ | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹                   | å‚™è€ƒ                   |
| ----------- | ---- | ------------------------------ | ---------------------- |
| Upload Page | âœ…   | `src/app/page.tsx`             | ãƒ¡ã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»é¢ |
| Report Page | âœ…   | `src/app/report/[id]/page.tsx` | è¬›è©•ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º       |
| Share Page  | âœ…   | `src/app/s/[id]/page.tsx`      | å…±æœ‰ãƒšãƒ¼ã‚¸             |

## APIãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼çŠ¶æ³

### ç¾åœ¨ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”»åƒé¸æŠ
   â†“
2. uploadImage() Server Action (ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†)
   â†“
3. generateCritique() Server Action (Gemini APIç›´æ¥å‘¼ã³å‡ºã—)
   â†“
4. Upstash Redisä¿å­˜ï¼ˆé–‹ç™ºæ™‚ã¯ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªï¼‰
   â†“
5. ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
```

### ç›®æ¨™å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”»åƒé¸æŠ
   â†“
2. uploadImage() â†’ /api/upload (Edge Function)
   â†“
3. ç”»åƒå‡¦ç† + EXIFæŠ½å‡º + Upstash Redisä¿å­˜
   â†“
4. generateCritique() â†’ /api/critique (Node Function)
   â†“
5. Gemini APIå‘¼ã³å‡ºã— + Upstash Redisæ›´æ–°
   â†“
6. çŸ­ç¸®URLç”Ÿæˆ + OGPç”»åƒç”Ÿæˆ
   â†“
7. å…±æœ‰å¯èƒ½ãªãƒ¬ãƒãƒ¼ãƒˆå®Œæˆ
```

## ãƒ†ã‚¹ãƒˆçŠ¶æ³

### âœ… å®Ÿè£…æ¸ˆã¿ãƒ†ã‚¹ãƒˆ

#### å˜ä½“ãƒ†ã‚¹ãƒˆ

- [x] **EXIFæŠ½å‡ºãƒ†ã‚¹ãƒˆ** (`src/lib/exif.test.ts`)
- [x] **ç”»åƒå‡¦ç†ãƒ†ã‚¹ãƒˆ** (`src/lib/image.test.ts`)
- [x] **è¬›è©•æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ** (`src/lib/critique.test.ts`)
- [x] **KVã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ** (`src/lib/kv.test.ts`) - 9ã¤ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

#### APIãƒ¢ãƒƒã‚¯

- [x] **MSWè¨­å®š** (`src/mocks/handlers.ts`)
- [x] **Gemini APIãƒ¢ãƒƒã‚¯** - ãƒ†ã‚¹ãƒˆç”¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹

### âŒ æœªå®Ÿè£…ãƒ†ã‚¹ãƒˆ

#### API Routeãƒ†ã‚¹ãƒˆ

- [ ] **Edge Functionãƒ†ã‚¹ãƒˆ** - `/api/upload`
- [ ] **Node Functionãƒ†ã‚¹ãƒˆ** - `/api/critique`
- [ ] **OGPç”Ÿæˆãƒ†ã‚¹ãƒˆ** - `/api/ogp`

#### çµ±åˆãƒ†ã‚¹ãƒˆ

- [ ] **E2Eãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ** - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’è¬›è©•â†’å…±æœ‰
- [ ] **ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ** - APIå¤±æ•—ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼
- [ ] **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ** - ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“æ¸¬å®š

## å“è³ªãƒ»éæ©Ÿèƒ½è¦ä»¶

### âœ… å¯¾å¿œæ¸ˆã¿

- [x] **TypeScriptå‹å®‰å…¨æ€§** - å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå¯¾å¿œ
- [x] **ESLint/Prettier** - ã‚³ãƒ¼ãƒ‰å“è³ªç®¡ç†
- [x] **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³** - ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ
- [x] **shadcn/ui** - ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### âŒ è¦å¯¾å¿œ

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- [ ] **P95 < 3ç§’** - ç›®æ¨™ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“
- [ ] **Core Web Vitals** - LCP, FID, CLSæœ€é©åŒ–
- [ ] **ç”»åƒæœ€é©åŒ–** - Next.js Imageä½¿ç”¨
- [ ] **ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º** - Code Splitting

#### ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

- [ ] **WCAG AAæº–æ‹ ** - è‰²ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ
- [ ] **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼å¯¾å¿œ** - aria-labelè¨­å®š
- [ ] **ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰** - OSè¨­å®šé€£å‹•

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- [ ] **CSPãƒ˜ãƒƒãƒ€ãƒ¼** - XSSå¯¾ç­–
- [ ] **CORSè¨­å®š** - ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³åˆ¶å¾¡
- [ ] **ãƒ¬ãƒ¼ãƒˆåˆ¶é™** - APIä½¿ç”¨é‡åˆ¶å¾¡
- [ ] **ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼** - ãƒ‡ãƒ¼ã‚¿å–æ‰±ã„æ˜ç¤º

## ç’°å¢ƒãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤

### âœ… è¨­å®šæ¸ˆã¿

- [x] **é–‹ç™ºç’°å¢ƒ** - `npm run dev`
- [x] **ãƒ“ãƒ«ãƒ‰è¨­å®š** - Next.js 15
- [x] **TypeScriptè¨­å®š** - å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯
- [x] **Tailwind CSS** - ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

### âŒ è¦è¨­å®š

#### Vercelè¨­å®š

- [ ] **ç’°å¢ƒå¤‰æ•°** - `GOOGLE_AI_API_KEY`, `UPSTASH_REDIS_*`
- [ ] **Upstash Redisçµ±åˆ** - MarketplaceçµŒç”±è¨­å®š
- [ ] **Edge/Node Functionè¨­å®š** - ãƒ©ãƒ³ã‚¿ã‚¤ãƒ æŒ‡å®š
- [ ] **ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š** - æœ¬ç•ªURL
- [ ] **åˆ†æè¨­å®š** - Vercel Analytics

#### ç›£è¦–ãƒ»ãƒ­ã‚°

- [ ] **Sentryçµ±åˆ** - ã‚¨ãƒ©ãƒ¼è¿½è·¡
- [ ] **ãƒ­ã‚°å‡ºåŠ›** - æ§‹é€ åŒ–ãƒ­ã‚°
- [ ] **ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š** - éšœå®³é€šçŸ¥
- [ ] **ä½¿ç”¨é‡ç›£è¦–** - ã‚³ã‚¹ãƒˆç®¡ç†

## æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é …ç›®

### å³åº§ã«ç€æ‰‹ï¼ˆæ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰

1. **Upstash Redisæ¥ç¶šè¨­å®š** âœ…
   - [x] KVã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…
   - [x] é–‹ç™ºæ™‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè£…
   - [x] å®Ÿéš›ã®Upstashã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
   - [x] ç’°å¢ƒå¤‰æ•°è¨­å®šã¨å‹•ä½œç¢ºèª

2. **API Routeå®Ÿè£…**
   - [ ] `/api/upload` Edge Function
   - [ ] `/api/critique` Node Function
   - [ ] Error handlingçµ±ä¸€

3. **Server Actionsä¿®æ­£**
   - [ ] API Routeå‘¼ã³å‡ºã—ã«å¤‰æ›´
   - [ ] Upstash Redisçµ±åˆ
   - [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼çµ±ä¸€

### ç¬¬2ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆ2-3é€±é–“ä»¥å†…ï¼‰

1. **OGPãƒ»å…±æœ‰æ©Ÿèƒ½**
   - [ ] `/api/ogp` å®Ÿè£…ï¼ˆSatoriï¼‰
   - [ ] çŸ­ç¸®URLæ©Ÿèƒ½
   - [ ] ã‚½ãƒ¼ã‚·ãƒ£ãƒ«å…±æœ‰ãƒ†ã‚¹ãƒˆ

2. **å“è³ªå‘ä¸Š**
   - [ ] E2Eãƒ†ã‚¹ãƒˆæ‹¡å……
   - [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
   - [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ

3. **é‹ç”¨æº–å‚™**
   - [ ] ç›£è¦–ãƒ»ãƒ­ã‚°è¨­å®š
   - [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œ
   - [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™

---

**æœ€çµ‚æ›´æ–°**: 2025-08-18  
**é‡è¦å¤‰æ›´**: Upstash Redisæ¥ç¶šè¨­å®šãƒ»å‹•ä½œç¢ºèªå®Œäº†ã€@upstash/redisãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å°å…¥  
**ãƒã‚§ãƒƒã‚¯åŸºæº–**: MVPå®Œæˆè¦ä»¶ï¼ˆè¦ä»¶ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæº–æ‹ ï¼‰  
**æ¬¡å›æ›´æ–°**: API Routeå®Ÿè£…å®Œäº†æ™‚
